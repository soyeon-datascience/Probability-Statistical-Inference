earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Simulation
walk_out_money <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 1000, M = 100))
}
# Estimated the number of plays before stopping
mean(number_of_plays)
# Simulation
walk_out_money <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 1000, M = 100))
}
# Estimated the number of plays before stopping
mean(number_of_plays)
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earninsg(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 250, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 250, W = 300, L = 1000, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 250)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 280, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 280, W = 300, L = 1000, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 280)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 400, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 400, L = 1000, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 30, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 30, L = 2000, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 1000, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 10, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-aixs is earnings.)
earnings <- one_series(B = 200, W = 300, L = 50, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Estimated earnings
mean(walk_out_money - 200)
# Showing how the gambler's earnings(or losses) evolve over a series of plays. (The x-axis is the play number and the y-axis is earnings.)
earnings <- one_series(B = 200, W = 300, L =  1000, M = 100) - 200
plot(c(1:length(earnings)), earnings,type="l", xlab="play number", ylab="Earnings")
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 30, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 30, L = 30, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 10, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 10, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 10, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 10, M = 100))
}
# Estimated probability of walking out with extra cash
mean(walk_out_money > 200)
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 5, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 5, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 5, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 5, M = 100))
}
# Estimated probability of walking out with extra cash
mean(walk_out_money > 200)
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 100, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 100, M = 100))
}
# Estimated probability of walking out with extra cash
mean(walk_out_money > 200)
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 500, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 500, M = 100))
}
# Estimated probability of walking out with extra cash
mean(walk_out_money > 200)
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 500, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 200, W = 300, L = 500, M = 100))
}
# Estimated probability of walking out with extra cash
mean(walk_out_money > 200)
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 200)
# Spin of the wheel
red <- rbinom(1,1,18/38)
plot(cars)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 100, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 100, W = 300, L = 1000, M = 100))
}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
library(magrittr)
library(tidyverse)
#' A single play of the Martingale strategy
#' number of plays  number, the number of plays in roulette
#' Takes a state list, spins the roulette wheel, returns the state list with updated values (for example, budget, plays, etc)
#' @param state A list with the following entries:
#'   B              number, the budget
#'   W              number, the budget threshold for successfully stopping
#'   L              number, the maximum number of plays
#'   M              number, the casino wager limit
#'   plays          integer, the number of plays executed
#'   previous_wager number, the wager in the previous play (0 at first play)
#'   previous_win   TRUE/FALSE, indicator if the previous play was a win (TRUE at first play)
#' @return The updated state list
one_play <- function(state){
# Wager
proposed_wager <- ifelse(state$previous_win, 1, 2*state$previous_wager)
wager <- min(proposed_wager, state$M, state$B)
# Spin of the wheel
red <- rbinom(1,1,18/38)
# Update state
state$plays <- state$plays + 1
state$previous_wager <- wager
if(red){
# WIN
state$B <- state$B + wager
state$previous_win <- TRUE
}else{
# LOSE
state$B <- state$B - wager
state$previous_win <- FALSE
}
state
}
#' Stopping rule
#'
#' Takes the state list and determines if the gambler has to stop
#' @param state A list.  See one_play
#' @return TRUE/FALSE
stop_play <- function(state){
if(state$B <= 0) return(TRUE)
if(state$plays >= state$L) return(TRUE)
if(state$B >= state$W) return(TRUE)
FALSE
}
#' Play roulette to either bankruptcy, success, or play limits
#'
#' @param B number, the starting budget
#' @param W number, the budget threshold for successfully stoping
#' @param L number, the maximum number of plays
#' @param M number, the casino wager limit
#' @return A vector of budget values calculated after each play.
one_series <- function(
B = 200
, W = 300
, L = 1000
, M = 100
){
# initial state
state <- list(
B = B
, W = W
, L = L
, M = M
, plays = 0
, previous_wager = 0
, previous_win = TRUE
)
# vector to store budget over series of plays
budget <- rep(NA, L)
# For loop of plays
for(i in 1:L){
new_state <- state %>% one_play
budget[i] <- new_state$B
if(new_state %>% stop_play){
return(budget[1:i])
}
state <- new_state
}
budget
}
# helper function
get_last <- function(x) x[length(x)]
# Simulation
walk_out_money <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 200, W = 300, L = 1000, M = 100) %>% get_last
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated probability of walking out with extra cash
mean(walk_out_money > 200)
# Estimated earnings
mean(walk_out_money - 200)
# Simulation
walk_out_money <- rep(NA, 10000)
number_of_plays <- rep(NA, 10000)
for(j in seq_along(walk_out_money)){
walk_out_money[j] <- one_series(B = 100, W = 300, L = 1000, M = 100) %>% get_last
number_of_plays[j] <- length(one_series(B= 100, W = 300, L = 1000, M = 100))
}
# Walk out money distribution
hist(walk_out_money, breaks = 100)
# Estimated earnings
mean(walk_out_money - 100)
