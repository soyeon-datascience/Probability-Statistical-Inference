"0","power.corr = function(N, rho){"
"0","  null_correlation <- 0.8"
"0","  R <- 5000"
"0","  power = NA"
"0","  for(j in 1:length(rho)) {"
"0","    sigma <- array(c(1,rho[j],rho[j],1), c(2,2))"
"0","    mu <- c(0,0)"
"0",""
"0","    detect <- rep(NA, R)"
"0","    for(i in 1:R){"
"0","      data <- rmvnorm(N[j], mean = mu, sigma = sigma)"
"0","      # Measurement A is data[,1]"
"0","      # Measurement B is data[,2]"
"0","      # Option Alternative = ""greater"" is one-sided 95% CI"
"0","      results <- cor.test(x = data[,1], y = data[,2], alternative = ""greater"")"
"0","  "
"0","      # Test is lower bound is strictly greater than 0.8"
"0","      detect[i] <- results$conf.int[1] > null_correlation"
"0","    }"
"0","    power[j] <- mean(detect)"
"0","  }"
"0","  return(power)"
"0","}"
"0",""
"0","# Sample Size"
"0","N <- c(25, 50, 75, 100)"
"0",""
"0","# True population correlation"
"0","rho <- seq(0.8, 0.95, by = 0.01)"
"0",""
"0","results1 <- expand.grid(N = N, rho = rho, power = NA)"
"0"," "
"0","for(i in 1:nrow(results1)) {"
"0","  results1[i,3] = power.corr(N = results1[i,1], rho = results1[i,2])"
"0","}"
"0",""
"0","ggplot(mapping = aes(x = rho, y = power, col = factor(N)), data = results1) +"
"0","  geom_line() + "
"0","  theme_bw() +"
"0","  labs(x = ""Correlation"", y = ""Power"")"
